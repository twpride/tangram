<h1 align="center">179 Tangrams</h1>

<div align="center" >
  <a href="https://twpride.github.io/tangram/">
  Live Site
  </a>
</div>


<br/>





<h3 align="center">
Screen Shots
</h3>
<br/>
<p align="center">
  <img width="480" height="auto" src="https://raw.githubusercontent.com/twpride/tangram/master/demo/collision_opt.gif">
</p>
<p align="center">
  <img width="480" height="auto" src="https://raw.githubusercontent.com/twpride/tangram/master/demo/gameplay_opt.gif">
</p>
<p align="center">
  <img width="480" height="auto" src="https://raw.githubusercontent.com/twpride/tangram/master/demo/slider_opt.gif">
</p>

https://github.com/twpride/tangram/blob/0c07e642bfcd7f677e55f7b4df2e97870f300b03/cubicBezier.js#L28-L40


### Overview
179 Tangrams is a browser implementation of a classic Chinese puzzle using JavaScript and the [Canvas API](https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API). The puzzle consists of seven polygons, which are put together to form shapes. The objective is to replicate a pattern (given only an outline) generally found in a puzzle book using all seven pieces without overlap.


## Game timing and scoring mechanics
- Player are scored by how quickly he/she can solve a level. 
- Once the player clicks on the level icon to start the puzzle, and a timer immediate starts
- The timer is stopped whenever the user exits the level (by hitting pause, or switching to another tab) or when the puzzle is solved.
- In the level selector menu, the player can preview the problem hovering over the level icon. Unsolved problems are blurred in the preview to prevent the player from getting a head start before staring the timer
- The level selector menu also functions as a heat map that tracks the player's progress. The heat maps colors each level icon depending on elapse time and solve state of each level. 


### Source of the puzzles
- Instead of generating the problem manually, examples of tangram problems found online were leveraged.
- The 179 puzzles in this game was taken from a [puzzle booklet](https://web.archive.org/web/20200203050759/https://www.cs.brandeis.edu/~storer/JimPuzzles/ZPAGES/zzzRichter08-AnchorPuzzle.html) first published in 1890 by the Richter Company of Germany in 1890.
- The problems was extracted from scanned images of puzzle booklet with a python script using OpenCv's `findContours()`.


### Collision Detection Algorithm
- After every piece move, the game checks if the moving piece has collided.

- If there was a collision, the penetration amount between the penetrating vertex and the penetrated edge is calculated

- The moving piece is then shifted back by the calculated intersection amount ensuring thats the pieces are no longer colliding


## Shape Rotation



### Puzzle solve state detection

- In order to record the time to completion for a puzzle, a method of detecting whether a puzzle was solved was need.
- The  

### Custom Carousel Element
- To allow for smooth transition between pages, the carousel utilizes a [Bezier easing function](https://github.com/gre/bezier-easing) to generate the animation of snapping to a page.



- The heatmap was generated by formatting an [HSL](https://developer.mozilla.org/en-US/docs/Web/CSS/color_value#hsl_colors) color string which becomes an attributes of a SVG [&lt;rect&gt;](https://developer.mozilla.org/en-US/docs/Web/SVG/Element/rect) element.







### Game Controls

- Piece translation
  - Mouse: Left click and drag
  - Touch: Tap and drag
- Piece rotation
  - Mouse: Right click and drag
  - Two-finger touch: With 1 finger touching the piece, drag with second finger
  - One-finger touch: Double tap piece. Drag on second tap
- Lifting a piece up
  - Mouse: double click
  - With touch: long press
  - Lifted pieces can move through other pieces
- Flipping the parallelogram
  - Click on button below the play/pause button.
- Exiting or pausing the puzzle
  - Click the pause button, or press <Escape>


